# Фронтенд Приложение CMS

## Обзор

Приложение следует модульной архитектуре и разработано с учетом масштабируемости и поддерживаемости, расширение функциональности происходит за счет плагинов.

## Структура Проекта

```
frontend/
├── src/                   # Исходный код
│   ├── bootstrap/         # Код инициализации приложения
│   ├── commands/          # Команды приложения
│   ├── core/              # Базовые интерфейсы и DI
│   └── middleware/        # Middleware
│       └── http/          # Middleware для обработки http-запросов/ответов
│   ├── plugins/           # Плагины-компоненты
│   ├── services/          # Сервисы бизнес-логики
│   └── shared/            # Общие компоненты и утилиты
├── public/                # Статические публичные ресурсы
├── nginx/                 # Конфигурация Nginx для продакшена
└── dist/                  # Директория сборки
```

## Технологический Стек

- **TypeScript**: Основной язык разработки
- **Nginx**: Для раздачи продакшен-сборки и статики
- **Docker**: Для контейнеризации

## Начало Работы

### Требования

- Node.js (v14 или выше)
- npm или yarn

### Установка

1. Установка зависимостей:

```bash
npm install
# или
yarn install
```

2. Запуск сервера разработки:

```bash
npm run dev
# или
yarn dev
```

## Принципы работы

1. Инициализация:

```ts
bootstrap();
```

2. Поток данных

```
Запрос URL → SlugService → PageService →
→ Загрузка данных → Обработка →
→ Создание компонентов → Рендеринг
```

3. Обработка ошибок:

- Автоматический fallback на заглушку при ошибках загрузки
- Единая точка обработки ошибок запросов

### Система плагинов

#### Структура плагина

Плагины представляют собой UI-компоненты, расположенные в папке plugins. Каждый плагин должен:

1. Экспортировать класс компонента, реализующий ICommand
2. Иметь метод execute, запускающий рендеринг текущего компонента
3. (Опционально) Может включать адаптер для преобразования props

#### Шаблон плагина

```ts
import type { MyComponentProps } from "./types";

export class MyComponent implements ICommand {
  private adapter<MyComponentProps>(params: Record<string, unknown>) {
    return {
      // преобразование параметров
    };
  }

  execute() {
    const props = this.adapter<ErrorSectionProps>(this._params);
    // логика рендеринга
    this._ctx.append(errorCode, title);
  }
}
```

#### Автоматическая загрузка

Плагины загружаются автоматически при старте приложения через:

```ts
const modules = import.meta.glob("../plugins/**/*.component.ts");
```

Особенности:

- Поддержка глубокой вложенности в папке plugins
- Имя файла должно содержать .component.ts
- Класс компонента регистрируется в DI-контейнере под своим именем

#### Конфигурация плагинов

Плагины получают параметры из конфига страницы:

```ts
// Конфиг страницы
{
  components: ["Header", "Section", "Footer", ""],
  params: {
    headerTitle: "Awesome CMS",
    copyrightText: "© 2025 My Awesome App",
    links: [
      { text: "Privacy Policy", url: "#privacy" },
      { text: "Terms of Service", url: "#terms" },
    ],
    title: "Welcome to Our App",
    content:
      "This is a demo application showcasing UI components with Design Patterns (IoC, Adapters, Commands, etc)",
    buttonText: "Get Started",
  },
}
```

#### Общие принципы разработки плагинов

1. Структура компонента:

   - Обязательная реализация ICommand
   - Метод render() рендерит текущий компонент в переданный родитель ctx: HTMLElement
   - Опциональный адаптер параметров

2. Стилизация:

   - Рекомендуется использовать инлайн-стили для изоляции

3. Типизация:

   - Отдельный файл types.ts для интерфейсов
   - Строгая типизация пропсов

4. Именование:

   - Файлы компонентов: [Name].component.ts
   - Имена классов в PascalCase

5. Регистрация:
   - Автоматическая при соблюдении структуры
   - Имя компонента = имя класса
